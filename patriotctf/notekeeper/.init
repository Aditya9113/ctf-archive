#!/bin/bash

# Download ld-linux-aarch64.so.1
wget https://github.com/angr/binaries/raw/master/tests/aarch64/ld-linux-aarch64.so.1 -O /lib/ld-linux-aarch64.so.1

# Make ld-linux-aarch64.so.1 executable
chmod +x /lib/ld-linux-aarch64.so.1

# Install necessary packages with automatic "yes" to prompts
y | sudo apt-get update
y | sudo apt-get install libc6-i386
y | sudo apt-get install qemu-user-static qemu-user binfmt-support
y | sudo apt-get install libc6-arm64-cross libc6-dev-arm64-cross
y | sudo apt-get install debootstrap

# Setup ARM root filesystem
sudo debootstrap --arch=arm64 focal ~/arm_root http://ports.ubuntu.com/

# Ensure qemu-aarch64-static is available in the ARM root filesystem
y | sudo apt-get install qemu-user-static
sudo cp /usr/bin/qemu-aarch64-static ~/arm_root/usr/bin/

# Run the ARM binary
qemu-aarch64 -L ~/arm_root ./note_keeper_arm

